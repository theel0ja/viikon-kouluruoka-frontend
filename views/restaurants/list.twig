{% extends 'layouts/default.twig' %}

{% block body %}
  <h1>{{ title|e }}</h1>
  <p>List of restaurants.</p>

  {% for category in categories %}
    <h3 id="category-{{ category.id }}">{{category.name}}</h3>
    <ul>
      {% for restaurant in restaurants if restaurant.category == category.id %}
        <li><a href="/restaurants/{{ restaurant.id }}">{{ restaurant.name }}</a></li>
      {% else %}
        <!-- TODO: Make better solution! -->
        <noscript>
          <style>
            #category-{{ category.id }} {
              visibility: hidden;
            }
          </style>
        </noscript>
        
        <script>
          document.getElementById("category-{{ category.id }}").outerHTML = "";
        </script>
      {% endfor %}
    </ul>
  {% endfor %}
{% endblock %}

{% block javascripts %}
  <script>
    const restaurantsData = {{ restaurantsJson }};
    const categoriesData = {{ categoriesJson }};
  </script>
{% endblock %}